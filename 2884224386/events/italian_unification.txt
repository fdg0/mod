namespace = italian_unification

# Unified italian_unification
italian_unification.1 = {
	type = country_event
	placement = ROOT

	title = italian_unification.1.t
	desc = italian_unification.1.d
	flavor = italian_unification.1.f

	event_image = {
		video = "gfx/event_pictures/unspecific_signed_contract.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/signed_contract"

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	duration = 3

	trigger = {
	}

	immediate = {
		ruler.interest_group = {
			save_scope_as = ruler_ig_scope
		}
	}

	option = {
		name = italian_unification.1.a
		default_option = yes
		# prestige
		add_modifier = {
			name = italian_unifier_prestige
			months = long_modifier_time
		}
	}
	option = {
		name = italian_unification.1.b
		# ruler IG attraction
		scope:ruler_ig_scope = {
			add_modifier = {
				name = italian_unifiers_ig
				months = normal_modifier_time
			}
		}
		change_infamy = -25
	}
}

# Annex an Italian country
italian_unification.2 = {
	type = country_event
	placement = ROOT

	title = italian_unification.2.t
	desc = italian_unification.2.d
	flavor = italian_unification.2.f

	event_image = {
		video = "gfx/event_pictures/unspecific_signed_contract.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/signed_contract"

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	duration = 1

	trigger = {
		any_neighbouring_state = {
			owner = {
				OR = {
					country_has_primary_culture = cu:north_italian
					country_has_primary_culture = cu:south_italian
				}
				OR = {
					is_subject = no
					is_subject_of = ROOT
				}
				has_diplomatic_pact = {
					who = ROOT
					type = customs_union
				}
				country_rank < rank_value:minor_power
				relations:root >= relations_threshold:amicable
				is_player = no
				NOT = { has_variable = italian_minor_dont_annex }
			}
		}
	}

	immediate = {
		random_neighbouring_state = {
			limit = {
				owner = {
					OR = {
						country_has_primary_culture = cu:north_italian
						country_has_primary_culture = cu:south_italian
					}
					OR = {
						is_subject = no
						is_subject_of = ROOT
					}
					has_diplomatic_pact = {
						who = ROOT
						type = customs_union
					}
					country_rank < rank_value:minor_power
					relations:root >= relations_threshold:amicable
					is_player = no
					NOT = { has_variable = italian_minor_dont_annex }
				}
			}
			owner = {
				save_scope_as = italian_annex_country
			}
		}
	}

	option = {
		name = italian_unification.2.a
		default_option = yes
		create_incident = {
			country = scope:italian_annex_country
			value = 10
		}
		annex = scope:italian_annex_country
		ai_chance = {
			base = 1
		}
	}
	option = {
		name = italian_unification.2.b
		change_relations = {
			country = scope:italian_annex_country
			value = 20
		}
		scope:italian_annex_country = {
			set_variable = {
				name = italian_minor_dont_annex
				months = normal_modifier_time
			}
		}
		ai_chance = {
			base = 0
		}
	}
}




# Garibaldi
italian_unification.3 = {
	type = country_event
	placement = ROOT

	title = italian_unification.3.t
	desc = italian_unification.3.d
	flavor = italian_unification.3.f

	event_image = {
		video = "gfx/event_pictures/europenorthamerica_before_the_battle.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/europenorthamerica/before_the_battle"

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	duration = 3

	trigger = {
		NOT = { has_global_variable = garibaldi_variable }
		NOT = { has_variable = garibaldi_var }
		has_global_variable = plebiscite_variable
		has_variable = plebiscite_var
		is_at_war = no
		game_date < 1882.1.1
	}

	immediate = {
		set_global_variable = garibaldi_variable
		set_variable = garibaldi_var
	}

	option = {
		name = italian_unification.3.a
		default_option = yes
		create_character = {
			first_name = Giuseppe
			last_name = Garibaldi
			is_general = yes
			interest_group = ig_armed_forces
			female = no
			birth_date = 1807.7.4
			dna = dna_giuseppe_garibaldi
			ideology = ideology_republican_leader
			traits = {
				resupply_commander
				surveyor
				expert_artillery_commander
			}
			on_created = {
				add_modifier = {
					name = garibaldi_popularity
				}
			}
		}
	}
	## option = {
	## 	name = italian_unification.3.b
	## 	create_character = {
	## 		first_name = Giuseppe
	## 		last_name = Garibaldi
	## 		ig_leader = yes
	## 		interest_group = ig_armed_forces
	## 		female = no
	## 		birth_date = 1807.7.4
	## 		dna = dna_giuseppe_garibaldi
	## 		ideology = ideology_republican_leader
	## 		traits = {
	## 			meticulous
	## 			cautious
	## 		}
	## 		on_created = {
	## 			add_modifier = {
	## 				name = garibaldi_popularity
	## 			}
	## 		}
	## 	}
	## }
}


########### Plebisciti ######
italian_unification.4 = {
	type = country_event
	placement = ROOT

	title = italian_unification.4.t
	desc = italian_unification.4.d

	event_image = {
		video = "gfx/event_pictures/unspecific_ruler_speaking_to_people.bk2"
	}

	trigger = {
		has_variable = plombieres_var
		has_global_variable = plombieres_accepted
		has_global_variable = second_independence_war
		is_at_war = no
		owns_entire_state_region = STATE_LOMBARDY
		NOT = { has_global_variable = plebiscite_variable }
		NOT = { has_variable = plebiscite_var }
	}

	immediate = {
		set_global_variable = plebiscite_variable
		set_variable = plebiscite_var
	}

	option = {
		name = italian_unification.4.a
		default_option = yes
		ai_chance = {
			base = 100
		}

		s:STATE_LAZIO = {
			set_owner_of_provinces = {
				country = c:SAR
				provinces = { "x3040A0" "xB0C0A0" "xB5726E" }			###	  "xB040A0" ROMA no
			}
		}
		s:STATE_EMILIA = {
			every_scope_state = {
				limit = {
					owner = {
						country_has_primary_culture = cu:north_italian
					}
				}
				set_state_owner = c:SAR
			}
		}
		s:STATE_TUSCANY = {
			every_scope_state = {
				limit = {
					owner = {
						country_has_primary_culture = cu:north_italian
					}
				}
				set_state_owner = c:SAR
			}
		}
		s:STATE_ROMAGNA = {
			every_scope_state = {
				limit = {
					owner = {
						country_has_primary_culture = cu:north_italian
					}
				}
				set_state_owner = c:SAR
			}
		}
		s:STATE_UMBRIA = {
			every_scope_state = {
				limit = {
					owner = {
						country_has_primary_culture = cu:north_italian
					}
				}
				set_state_owner = c:SAR
			}
		}

		# Cede Nizza + Savoy
		if = {
			limit = {
				exists = s:STATE_SAVOY.region_state:SAR
			}
			s:STATE_SAVOY.region_state:SAR = { set_state_owner = c:FRA }
		}
		if = {
			limit = {
				exists = s:STATE_PROVENCE.region_state:SAR
			}
			s:STATE_PROVENCE.region_state:SAR = { set_state_owner = c:FRA }
		}
		change_infamy = -30

		### ALL DONE - Alliance no longer needed ####
		c:SAR = {
			remove_diplomatic_pact = {
				country = c:FRA
				type = alliance
			}
		}
		c:SAR = {
			create_diplomatic_pact = {
				country = c:FRA
				type = defensive_pact
			}
		}
	}

	option = {
		name =  italian_unification.4.b
		ai_chance = {
			base = 0
		}
	}

}


########### Plombieres ######

italian_unification.5 = {
	type = country_event
	placement = ROOT

	title = italian_unification.5.t
	desc =  italian_unification.5.d

	event_image = {
		video = "gfx/event_pictures/unspecific_signed_contract.bk2"
	}

	trigger = {
		NOT = { has_global_variable = plombieres_variable }
		NOT = { has_variable = plombieres_var }
		game_date > 1848.1.1


		exists = c:SAR
		c:SAR = ROOT

		OR = {
			exists = s:STATE_SAVOY.region_state:SAR
			exists = s:STATE_PROVENCE.region_state:SAR
		}

		exists = c:AUS
		exists = s:STATE_LOMBARDY.region_state:AUS

		c:FRA = {
			is_at_war = no
		}

		is_at_war = no

		c:FRA = {
			relations:root >= relations_threshold:cordial
			NOT = { has_war_with = ROOT }
		}
	}

	immediate = {
		set_global_variable = plombieres_variable
		set_variable = plombieres_var
	}

	option = {
		name =  italian_unification.5.a
		default_option = yes
		c:SAR = {
			create_diplomatic_pact = {
				country = c:FRA
				type = alliance
			}
		}
		ai_chance = {
			base = 100
		}
		set_global_variable = plombieres_accepted
	}

	option = {
		name =  italian_unification.5.b
		ai_chance = {
			base = 0
		}
		set_global_variable = plombieres_refused
	}
}


########### Second Independence WAR ######

italian_unification.6 = {
	type = country_event
	placement = ROOT

	type = country_event
	placement = ROOT

	title = italian_unification.6.t
	desc =  italian_unification.6.d

	event_image = {
		video = "gfx/event_pictures/europenorthamerica_before_the_battle.bk2"
	}

	trigger = {
		has_variable = plombieres_var
		has_global_variable = plombieres_accepted
		NOT = { has_global_variable = second_independence_war }
		exists = c:AUS
		exists = s:STATE_LOMBARDY.region_state:AUS
	}

	immediate = {
		set_global_variable = second_independence_war
	}

	option = {
		name =  italian_unification.6.a
		default_option = yes
		create_diplomatic_play = {
			target_country = c:AUS
			war = yes
			type = dp_conquer_state
			target_state = s:STATE_LOMBARDY.region_state:AUS
		}
		ai_chance = {
			base = 100
		}
	}
	option = {
		name =  italian_unification.6.b

		ai_chance = {
			base = 0
		}
	}

}

########### I Mille ######

italian_unification.7 = {
	type = country_event
	placement = ROOT

	type = country_event
	placement = ROOT

	title = italian_unification.7.t
	desc =  italian_unification.7.d

	event_image = {
		video = "gfx/event_pictures/europenorthamerica_before_the_battle.bk2"
	}

	trigger = {
		OR = {
			has_global_variable = garibaldi_variable
			has_variable = garibaldi_var
		}
		has_global_variable = plebiscite_variable
		NOT = { has_global_variable = i_mille }
		is_at_war = no

	}

	immediate = {
		set_global_variable = i_mille
	}

	option = {
		name =  italian_unification.7.a
		default_option = yes
		create_diplomatic_play = {
			target_country = c:SIC
			war = yes
			type = dp_annex_war
		}

		ai_chance = {
			base = 100
		}
	}
	option = {
		name =  italian_unification.7.b

		ai_chance = {
			base = 0
		}
	}

}
